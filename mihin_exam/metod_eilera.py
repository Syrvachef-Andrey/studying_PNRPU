# Решение системы ОДУ методом Эйлера

# Параметры
h = 0.25  # шаг интегрирования
t_end = 1.0  # конечное время
y = 1.0  # начальное условие y(0)
z = 0.5  # начальное условие z(0)
t = 0.0  # начальное время

print("Метод Эйлера для системы:")
print("dy/dt = -2y + x, где x(t) = t - 0.01")
print("dz/dt = 0.1y - 3z - y*z")
print(f"Шаг h = {h}")
print()

print(f"{'t':>4} {'x(t)':>8} {'y':>10} {'z':>10} {'dy/dt':>10} {'dz/dt':>10}")
print("-" * 65)

# Цикл интегрирования
step = 0
while t <= t_end:
    # Входной сигнал
    x = t - 0.01

    # Производные
    dy_dt = -2 * y + x
    dz_dt = 0.1 * y - 3 * z - y * z

    # Вывод текущего состояния
    print(f"{t:4.2f} {x:8.4f} {y:10.6f} {z:10.6f} {dy_dt:10.6f} {dz_dt:10.6f}")

    # Если достигли конечного времени - выходим
    if t >= t_end:
        break

    # Шаг метода Эйлера
    y = y + h * dy_dt
    z = z + h * dz_dt
    t = t + h
    step += 1

print("-" * 65)
print(f"Результат в t = {t_end}:")
print(f"y({t_end}) = {y:.6f}")
print(f"z({t_end}) = {z:.6f}")